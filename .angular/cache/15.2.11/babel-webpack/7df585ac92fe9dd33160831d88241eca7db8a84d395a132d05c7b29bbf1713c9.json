{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/employee.service\";\nimport * as i2 from \"../../services/auth.service\";\nimport * as i3 from \"../../services/translation.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction EmployeeListComponent_option_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const position_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"value\", position_r3.id)(\"disabled\", ctx_r0.getEmployeesCountByPosition(position_r3.id) === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", position_r3.name, \" (\", ctx_r0.getEmployeesCountByPosition(position_r3.id), \") \");\n  }\n}\nfunction EmployeeListComponent_table_21_tr_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"currency\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const employee_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r5.employee_id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r5.last_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r5.first_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r5.position_name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(employee_r5.contact_email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(13, 6, employee_r5.salary));\n  }\n}\nfunction EmployeeListComponent_table_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 14)(1, \"thead\")(2, \"tr\")(3, \"th\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"th\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"th\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"th\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(15, \"tbody\");\n    i0.ɵɵtemplate(16, EmployeeListComponent_table_21_tr_16_Template, 14, 8, \"tr\", 15);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r1.translationService.translate(\"EMPLOYEE.FIELDS.EMPLOYEE_ID\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.translationService.translate(\"EMPLOYEE.FIELDS.LAST_NAME\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.translationService.translate(\"EMPLOYEE.FIELDS.FIRST_NAME\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.translationService.translate(\"EMPLOYEE.FIELDS.POSITION\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.translationService.translate(\"EMPLOYEE.FIELDS.EMAIL\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.translationService.translate(\"EMPLOYEE.FIELDS.SALARY\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.filteredEmployees);\n  }\n}\nfunction EmployeeListComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16)(1, \"p\");\n    i0.ɵɵtext(2, \"\\u041D\\u0435\\u0442 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 \\u0434\\u043B\\u044F \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let EmployeeListComponent = /*#__PURE__*/(() => {\n  var _EmployeeListComponent;\n  class EmployeeListComponent {\n    constructor(employeeService, authService, translationService // ДОБАВИТЬ КАК PUBLIC\n    ) {\n      this.employeeService = employeeService;\n      this.authService = authService;\n      this.translationService = translationService;\n      this.employees = [];\n      this.positions = [];\n      this.filteredEmployees = [];\n      this.sortBy = 'last_name';\n      this.filterPosition = '';\n      this.isAdmin = false;\n    }\n    ngOnInit() {\n      this.authService.isLoggedIn().subscribe(isLoggedIn => {\n        this.isAdmin = isLoggedIn;\n      });\n      // Сначала загружаем должности, потом сотрудников\n      this.loadPositions();\n    }\n    loadPositions() {\n      this.employeeService.getPositions().subscribe({\n        next: positions => {\n          this.positions = positions;\n          // После загрузки должностей загружаем сотрудников\n          this.loadEmployees();\n        },\n        error: error => {\n          console.error('Error loading positions:', error);\n          // Все равно пытаемся загрузить сотрудников\n          this.loadEmployees();\n        }\n      });\n    }\n    loadEmployees() {\n      this.employeeService.getEmployees().subscribe({\n        next: employees => {\n          this.employees = employees;\n          this.applyFilters();\n        },\n        error: error => console.error('Error loading employees:', error)\n      });\n    }\n    applyFilters() {\n      let filtered = [...this.employees];\n      // Фильтрация по должности (выпадающий список)\n      if (this.filterPosition && this.filterPosition !== 'all') {\n        filtered = filtered.filter(emp => emp.position_id === parseInt(this.filterPosition));\n      }\n      // Сортировка\n      filtered.sort((a, b) => {\n        switch (this.sortBy) {\n          case 'last_name':\n            return a.last_name.localeCompare(b.last_name);\n          case 'position':\n            return (a.position_name || '').localeCompare(b.position_name || '');\n          default:\n            return 0;\n        }\n      });\n      this.filteredEmployees = filtered;\n    }\n    onSortChange(sortBy) {\n      this.sortBy = sortBy;\n      this.applyFilters();\n    }\n    onFilterChange(event) {\n      this.filterPosition = event.target.value;\n      this.applyFilters();\n    }\n    onPositionFilterChange(positionId) {\n      this.filterPosition = positionId;\n      this.applyFilters();\n    }\n    // Сброс фильтров\n    resetFilters() {\n      this.filterPosition = '';\n      this.sortBy = 'last_name';\n      this.applyFilters();\n    }\n    // Получить название выбранной должности\n    getSelectedPositionName() {\n      if (!this.filterPosition || this.filterPosition === 'all') {\n        return 'Все должности';\n      }\n      const position = this.positions.find(pos => pos.id === parseInt(this.filterPosition));\n      return position ? position.name : 'Неизвестная должность';\n    }\n    // Получить количество сотрудников по должности\n    getEmployeesCountByPosition(positionId) {\n      return this.employees.filter(emp => emp.position_id === positionId).length;\n    }\n  }\n  _EmployeeListComponent = EmployeeListComponent;\n  _EmployeeListComponent.ɵfac = function EmployeeListComponent_Factory(t) {\n    return new (t || _EmployeeListComponent)(i0.ɵɵdirectiveInject(i1.EmployeeService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.TranslationService));\n  };\n  _EmployeeListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _EmployeeListComponent,\n    selectors: [[\"app-employee-list\"]],\n    decls: 23,\n    vars: 9,\n    consts: [[1, \"employee-list\"], [1, \"header-actions\"], [1, \"filters\"], [1, \"filter-group\"], [3, \"change\"], [\"value\", \"last_name\"], [\"value\", \"position\"], [1, \"position-filter\", 3, \"value\", \"change\"], [\"value\", \"all\"], [3, \"value\", \"disabled\", 4, \"ngFor\", \"ngForOf\"], [1, \"table-container\"], [\"class\", \"table\", 4, \"ngIf\"], [\"class\", \"no-data\", 4, \"ngIf\"], [3, \"value\", \"disabled\"], [1, \"table\"], [4, \"ngFor\", \"ngForOf\"], [1, \"no-data\"]],\n    template: function EmployeeListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"div\", 3)(6, \"label\");\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"select\", 4);\n        i0.ɵɵlistener(\"change\", function EmployeeListComponent_Template_select_change_8_listener($event) {\n          return ctx.onSortChange($event.target.value);\n        });\n        i0.ɵɵelementStart(9, \"option\", 5);\n        i0.ɵɵtext(10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"option\", 6);\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(13, \"div\", 3)(14, \"label\");\n        i0.ɵɵtext(15);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"select\", 7);\n        i0.ɵɵlistener(\"change\", function EmployeeListComponent_Template_select_change_16_listener($event) {\n          return ctx.onPositionFilterChange($event.target.value);\n        });\n        i0.ɵɵelementStart(17, \"option\", 8);\n        i0.ɵɵtext(18, \"\\u0412\\u0441\\u0435 \\u0434\\u043E\\u043B\\u0436\\u043D\\u043E\\u0441\\u0442\\u0438\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(19, EmployeeListComponent_option_19_Template, 2, 4, \"option\", 9);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(20, \"div\", 10);\n        i0.ɵɵtemplate(21, EmployeeListComponent_table_21_Template, 17, 7, \"table\", 11);\n        i0.ɵɵtemplate(22, EmployeeListComponent_div_22_Template, 3, 0, \"div\", 12);\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.translationService.translate(\"EMPLOYEE.LIST\"));\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"\", ctx.translationService.translate(\"FILTERS.SORT_BY\"), \":\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.translationService.translate(\"FILTERS.LAST_NAME\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.translationService.translate(\"FILTERS.POSITION\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", ctx.translationService.translate(\"FILTERS.FILTER_BY_POSITION\"), \":\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"value\", ctx.filterPosition);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.positions);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.filteredEmployees.length > 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.filteredEmployees.length === 0);\n      }\n    },\n    dependencies: [i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i4.CurrencyPipe],\n    styles: [\".employee-list[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.3rem}.employee-list[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#1e3a8a;margin:0}.employee-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]{display:flex;gap:1.3rem;margin-bottom:1.3rem;flex-wrap:wrap}.employee-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.employee-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#1e3a8a;white-space:nowrap}.employee-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .employee-list[_ngcontent-%COMP%]   .filters[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem;border:2px solid #8ea5e6;border-radius:8px;min-width:150px}.employee-list[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{background:#FFFFFF;border-radius:8px;box-shadow:0 4px 6px #0000001a;padding:1.3rem;margin-bottom:.9rem;overflow-x:auto}.employee-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#FFFFFF}.employee-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .employee-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.9rem;text-align:left;border-bottom:1px solid #e1e7f9}.employee-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#1E3A8A;color:#fff;font-weight:700;position:-webkit-sticky;position:sticky;top:0}.employee-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#ffecac}.employee-list[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]{text-align:center;padding:1.8rem;color:#3a62d4;font-style:italic}\"]\n  });\n  return EmployeeListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}